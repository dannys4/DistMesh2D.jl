
function fd(p)
    return sqrt(sum(p .^ 2)) - 1
end

function fh(p)
    return 1.0
end

@testset "Generate simple meshes" begin
    expectedx = [-0.8408297336717067, -0.6993829085766673, NaN, -0.5315455685570857, -0.6993829085766673, NaN, -0.5822722080639808, -0.6993829085766673, NaN, -0.5822722080639808, -0.8408297336717067, NaN, -0.32741234296265387, -0.5822722080639808, NaN, -0.10822297816755844, -0.32741234296265387, NaN, -0.3335699234907137, -0.5315455685570857, NaN, -0.3335699234907137, -0.1139714018712159, NaN, -0.4304740520999244, -0.6993829085766673, NaN, -0.4304740520999244, -0.5315455685570857, NaN, -0.4304740520999244, -0.5822722080639808, NaN, -0.4304740520999244, -0.32741234296265387, NaN, -0.4304740520999244, -0.3335699234907137, NaN, -0.21591334072939405, -0.1139714018712159, NaN, -0.21591334072939405, -0.32741234296265387, NaN, -0.21591334072939405, -0.10822297816755844, NaN, -0.21591334072939405, -0.3335699234907137, NaN, -0.21591334072939405, -0.4304740520999244, NaN, 0.33365852781495375, 0.43053965875128, NaN, 0.11407015707401125, -0.1139714018712159, NaN, 0.11407015707401125, 0.33365852781495375, NaN, 0.10828460458514644, -0.10822297816755844, NaN, 4.28372215368622e-5, -0.1139714018712159, NaN, 4.28372215368622e-5, -0.10822297816755844, NaN, 4.28372215368622e-5, -0.21591334072939405, NaN, 4.28372215368622e-5, 0.11407015707401125, NaN, 4.28372215368622e-5, 0.10828460458514644, NaN, 0.2159934297012609, 0.43053965875128, NaN, 0.2159934297012609, 0.33365852781495375, NaN, 0.2159934297012609, 0.11407015707401125, NaN, 0.2159934297012609, 0.10828460458514644, NaN, 0.2159934297012609, 4.28372215368622e-5, NaN, 0.3274649744428817, 0.43053965875128, NaN, 0.3274649744428817, 0.10828460458514644, NaN, 0.3274649744428817, 0.2159934297012609, NaN, 0.5316191415774658, 0.43053965875128, NaN, 0.5316191415774658, 0.33365852781495375, NaN, 0.5823181042187109, 0.43053965875128, NaN, 0.5823181042187109, 0.3274649744428817, NaN, 0.5823181042187109, 0.8408712960674063, NaN, 0.699442901289095, 0.43053965875128, NaN, 0.699442901289095, 0.8408712960674063, NaN, 0.699442901289095, 0.5316191415774658, NaN, 0.699442901289095, 0.5823181042187109, NaN, 0.7022744483458028, 0.8408712960674063, NaN, 0.7022744483458028, 0.5823181042187109, NaN, 0.5641432582352885, 0.7022744483458028, NaN, 0.9435774410742437, 0.8408712960674063, NaN, 0.9435774410742437, 0.7022744483458028, NaN, 0.9955830193451991, 0.9435774410742437, NaN, 0.7842691318912671, 0.7022744483458028, NaN, 0.7842691318912671, 0.5641432582352885, NaN, 0.7842691318912671, 0.9435774410742437, NaN, 0.7842691318912671, 0.9955830193451991, NaN, 0.33839623589740286, 0.5641432582352885, NaN, 0.22094808661986476, 0.10828460458514644, NaN, 0.22094808661986476, 0.3274649744428817, NaN, 0.22094808661986476, 0.33839623589740286, NaN, 0.46012319612367936, 0.3274649744428817, NaN, 0.46012319612367936, 0.5823181042187109, NaN, 0.46012319612367936, 0.7022744483458028, NaN, 0.46012319612367936, 0.5641432582352885, NaN, 0.46012319612367936, 0.33839623589740286, NaN, 0.46012319612367936, 0.22094808661986476, NaN, 0.11077616961157855, 0.33839623589740286, NaN, 0.11077616961157855, 0.22094808661986476, NaN, 1.6220567122804397e-5, -0.10822297816755844, NaN, 1.6220567122804397e-5, 0.10828460458514644, NaN, 1.6220567122804397e-5, 0.22094808661986476, NaN, 1.6220567122804397e-5, 0.11077616961157855, NaN, -0.4600956257523193, -0.5822722080639808, NaN, -0.4600956257523193, -0.32741234296265387, NaN, -0.22091847404901555, -0.32741234296265387, NaN, -0.22091847404901555, -0.10822297816755844, NaN, -0.22091847404901555, 1.6220567122804397e-5, NaN, -0.22091847404901555, -0.4600956257523193, NaN, -0.3383935978143242, -0.4600956257523193, NaN, -0.3383935978143242, -0.22091847404901555, NaN, -0.11077497608971809, 0.11077616961157855, NaN, -0.11077497608971809, 1.6220567122804397e-5, NaN, -0.11077497608971809, -0.22091847404901555, NaN, -0.11077497608971809, -0.3383935978143242, NaN, -0.9435557880545353, -0.8408297336717067, NaN, -0.7022510454067321, -0.8408297336717067, NaN, -0.7022510454067321, -0.5822722080639808, NaN, -0.7022510454067321, -0.4600956257523193, NaN, -0.7022510454067321, -0.9435557880545353, NaN, -0.995578187456494, -0.9435557880545353, NaN, -0.7842665699904638, -0.9435557880545353, NaN, -0.7842665699904638, -0.7022510454067321, NaN, -0.7842665699904638, -0.995578187456494, NaN, -0.5641397587351197, -0.4600956257523193, NaN, -0.5641397587351197, -0.3383935978143242, NaN, -0.5641397587351197, -0.7022510454067321, NaN, -0.5641397587351197, -0.7842665699904638, NaN, -0.9851251782926934, -0.995578187456494, NaN, -0.6480977327304768, -0.7842665699904638, NaN, -0.6480977327304768, -0.5641397587351197, NaN, -0.6480977327304768, -0.5586564752225227, NaN, -0.9127024017758671, -0.9851251782926934, NaN, -0.7733005001500833, -0.5586564752225227, NaN, -0.7733005001500833, -0.9851251782926934, NaN, -0.7733005001500833, -0.6480977327304768, NaN, -0.7733005001500833, -0.9127024017758671, NaN, -0.8442549838381621, -0.995578187456494, NaN, -0.8442549838381621, -0.7842665699904638, NaN, -0.8442549838381621, -0.9851251782926934, NaN, -0.8442549838381621, -0.6480977327304768, NaN, -0.8442549838381621, -0.7733005001500833, NaN, -0.6862666283854642, -0.5586564752225227, NaN, -0.6862666283854642, -0.9127024017758671, NaN, -0.6862666283854642, -0.7733005001500833, NaN, -0.3355010354626309, -0.5586564752225227, NaN, -0.21947951364657692, -0.3355010354626309, NaN, -0.21947951364657692, -2.148402716051212e-5, NaN, -0.22164126063777267, -0.3383935978143242, NaN, -0.22164126063777267, -0.11077497608971809, NaN, -0.22164126063777267, -0.3355010354626309, NaN, -0.4516527838398483, -0.5586564752225227, NaN, -0.4516527838398483, -0.6862666283854642, NaN, -0.4516527838398483, -0.3355010354626309, NaN, -0.4516527838398483, -0.21947951364657692, NaN, -0.4396871073510433, -0.3383935978143242, NaN, -0.4396871073510433, -0.5641397587351197, NaN, -0.4396871073510433, -0.5586564752225227, NaN, -0.4396871073510433, -0.6480977327304768, NaN, -0.4396871073510433, -0.3355010354626309, NaN, -0.4396871073510433, -0.22164126063777267, NaN, -1.1579571875253158e-5, 0.11077616961157855, NaN, -1.1579571875253158e-5, -0.11077497608971809, NaN, -1.1579571875253158e-5, -0.22164126063777267, NaN, -0.11087391449373662, -0.3355010354626309, NaN, -0.11087391449373662, -2.148402716051212e-5, NaN, -0.11087391449373662, -0.21947951364657692, NaN, -0.11087391449373662, -0.22164126063777267, NaN, -0.11087391449373662, -1.1579571875253158e-5, NaN, 0.2194397482729209, -2.148402716051212e-5, NaN, 0.4516218798268037, 0.2194397482729209, NaN, 0.43966998901112797, 0.5641432582352885, NaN, 0.43966998901112797, 0.33839623589740286, NaN, 0.22162007075927415, 0.33839623589740286, NaN, 0.22162007075927415, 0.11077616961157855, NaN, 0.22162007075927415, -1.1579571875253158e-5, NaN, 0.22162007075927415, 0.43966998901112797, NaN, 0.11083715160593233, -2.148402716051212e-5, NaN, 0.11083715160593233, -1.1579571875253158e-5, NaN, 0.11083715160593233, -0.11087391449373662, NaN, 0.11083715160593233, 0.2194397482729209, NaN, 0.11083715160593233, 0.22162007075927415, NaN, 0.33546924537972433, 0.2194397482729209, NaN, 0.33546924537972433, 0.4516218798268037, NaN, 0.33546924537972433, 0.43966998901112797, NaN, 0.33546924537972433, 0.22162007075927415, NaN, 0.33546924537972433, 0.11083715160593233, NaN, 0.9851186595168906, 0.9955830193451991, NaN, 0.9851186595168906, 0.9126900848755652, NaN, 0.5586339874906727, 0.4516218798268037, NaN, 0.5586339874906727, 0.43966998901112797, NaN, 0.5586339874906727, 0.33546924537972433, NaN, 0.6480848023631789, 0.5641432582352885, NaN, 0.6480848023631789, 0.7842691318912671, NaN, 0.6480848023631789, 0.43966998901112797, NaN, 0.6480848023631789, 0.5586339874906727, NaN, 0.7732892957287478, 0.9126900848755652, NaN, 0.7732892957287478, 0.9851186595168906, NaN, 0.7732892957287478, 0.5586339874906727, NaN, 0.7732892957287478, 0.6480848023631789, NaN, 0.6862495125256922, 0.4516218798268037, NaN, 0.6862495125256922, 0.9126900848755652, NaN, 0.6862495125256922, 0.5586339874906727, NaN, 0.6862495125256922, 0.7732892957287478, NaN, 0.844245559696331, 0.9955830193451991, NaN, 0.844245559696331, 0.7842691318912671, NaN, 0.844245559696331, 0.9851186595168906, NaN, 0.844245559696331, 0.6480848023631789, NaN, 0.844245559696331, 0.7732892957287478, NaN, 0.5633569624513042, 0.4516218798268037, NaN, 0.5633569624513042, 0.6862495125256922, NaN, 0.6061736723727087, 0.5633569624513042, NaN, 0.7846776696722015, 0.9126900848755652, NaN, 0.7846776696722015, 0.6862495125256922, NaN, 0.7846776696722015, 0.5633569624513042, NaN, 0.7846776696722015, 0.6061736723727087, NaN, 0.10582071216622468, -2.148402716051212e-5, NaN, 0.10582071216622468, 0.2194397482729209, NaN, 0.3227720953970208, 0.2194397482729209, NaN, 0.3227720953970208, 0.4516218798268037, NaN, 0.3227720953970208, 0.5633569624513042, NaN, 0.3227720953970208, 0.10582071216622468, NaN, 0.4194323186978084, 0.5633569624513042, NaN, 0.4194323186978084, 0.6061736723727087, NaN, 0.4194323186978084, 0.3227720953970208, NaN, 0.2063997294839397, 0.10582071216622468, NaN, 0.2063997294839397, 0.3227720953970208, NaN, 0.2063997294839397, 0.4194323186978084, NaN, 0.12438677171849677, 0.2063997294839397, NaN, 0.3675511105098097, 0.6061736723727087, NaN, 0.3675511105098097, 0.4194323186978084, NaN, 0.3675511105098097, 0.2063997294839397, NaN, 0.3675511105098097, 0.12438677171849677, NaN, -9.449590732901747e-6, 0.10582071216622468, NaN, -9.449590732901747e-6, 0.2063997294839397, NaN, -9.449590732901747e-6, 0.12438677171849677, NaN, -0.20641560911852197, -9.449590732901747e-6, NaN, -0.41944418509899317, -0.20641560911852197, NaN, -0.10585625262155374, -2.148402716051212e-5, NaN, -0.10585625262155374, -0.21947951364657692, NaN, -0.10585625262155374, 0.10582071216622468, NaN, -0.10585625262155374, -9.449590732901747e-6, NaN, -0.10585625262155374, -0.20641560911852197, NaN, -0.32280143196261646, -0.21947951364657692, NaN, -0.32280143196261646, -0.4516527838398483, NaN, -0.32280143196261646, -0.20641560911852197, NaN, -0.32280143196261646, -0.41944418509899317, NaN, -0.32280143196261646, -0.10585625262155374, NaN, -0.36756281453508466, -0.20641560911852197, NaN, -0.36756281453508466, -0.41944418509899317, NaN, -0.12439979335282736, 0.12438677171849677, NaN, -0.12439979335282736, -9.449590732901747e-6, NaN, -0.12439979335282736, -0.20641560911852197, NaN, -0.12439979335282736, -0.36756281453508466, NaN, -0.7846917737263828, -0.9127024017758671, NaN, -0.7846917737263828, -0.6862666283854642, NaN, -0.5633752938295506, -0.6862666283854642, NaN, -0.5633752938295506, -0.4516527838398483, NaN, -0.5633752938295506, -0.41944418509899317, NaN, -0.5633752938295506, -0.32280143196261646, NaN, -0.5633752938295506, -0.7846917737263828, NaN, -0.60618605865758, -0.41944418509899317, NaN, -0.60618605865758, -0.36756281453508466, NaN, -0.60618605865758, -0.7846917737263828, NaN, -0.60618605865758, -0.5633752938295506, NaN]

    expectedy = [-0.5412996931425073, -0.7147471921795109, NaN, -0.8470296986801119, -0.7147471921795109, NaN, -0.5521369576265936, -0.7147471921795109, NaN, -0.5521369576265936, -0.5412996931425073, NaN, -0.5503919972289465, -0.5521369576265936, NaN, -0.5830667397437255, -0.5503919972289465, NaN, -0.9427253603352239, -0.8470296986801119, NaN, -0.9427253603352239, -0.9934840308228855, NaN, -0.7073907229778811, -0.7147471921795109, NaN, -0.7073907229778811, -0.8470296986801119, NaN, -0.7073907229778811, -0.5521369576265936, NaN, -0.7073907229778811, -0.5503919972289465, NaN, -0.7073907229778811, -0.9427253603352239, NaN, -0.7710587492712864, -0.9934840308228855, NaN, -0.7710587492712864, -0.5503919972289465, NaN, -0.7710587492712864, -0.5830667397437255, NaN, -0.7710587492712864, -0.9427253603352239, NaN, -0.7710587492712864, -0.7073907229778811, NaN, -0.942694004979451, -0.707346126180044, NaN, -0.993472696690797, -0.9934840308228855, NaN, -0.993472696690797, -0.942694004979451, NaN, -0.5830517748177085, -0.5830667397437255, NaN, -0.7938728718548367, -0.9934840308228855, NaN, -0.7938728718548367, -0.5830667397437255, NaN, -0.7938728718548367, -0.7710587492712864, NaN, -0.7938728718548367, -0.993472696690797, NaN, -0.7938728718548367, -0.5830517748177085, NaN, -0.7710337157104038, -0.707346126180044, NaN, -0.7710337157104038, -0.942694004979451, NaN, -0.7710337157104038, -0.993472696690797, NaN, -0.7710337157104038, -0.5830517748177085, NaN, -0.7710337157104038, -0.7938728718548367, NaN, -0.5503503559309882, -0.707346126180044, NaN, -0.5503503559309882, -0.5830517748177085, NaN, -0.5503503559309882, -0.7710337157104038, NaN, -0.8469835230342928, -0.707346126180044, NaN, -0.8469835230342928, -0.942694004979451, NaN, -0.5520811478404286, -0.707346126180044, NaN, -0.5520811478404286, -0.5503503559309882, NaN, -0.5520811478404286, -0.5412351267702223, NaN, -0.7146884832600638, -0.707346126180044, NaN, -0.7146884832600638, -0.5412351267702223, NaN, -0.7146884832600638, -0.8469835230342928, NaN, -0.7146884832600638, -0.5520811478404286, NaN, -0.3765635931191609, -0.5412351267702223, NaN, -0.3765635931191609, -0.5520811478404286, NaN, -0.18953181215346349, -0.3765635931191609, NaN, -0.3311519483926073, -0.5412351267702223, NaN, -0.3311519483926073, -0.3765635931191609, NaN, -0.09388531123764621, -0.3311519483926073, NaN, -0.18247111203820143, -0.3765635931191609, NaN, -0.18247111203820143, -0.18953181215346349, NaN, -0.18247111203820143, -0.3311519483926073, NaN, -0.18247111203820143, -0.09388531123764621, NaN, -0.18897038004249112, -0.18953181215346349, NaN, -0.3748885343552608, -0.5830517748177085, NaN, -0.3748885343552608, -0.5503503559309882, NaN, -0.3748885343552608, -0.18897038004249112, NaN, -0.3769919718881114, -0.5503503559309882, NaN, -0.3769919718881114, -0.5520811478404286, NaN, -0.3769919718881114, -0.3765635931191609, NaN, -0.3769919718881114, -0.18953181215346349, NaN, -0.3769919718881114, -0.18897038004249112, NaN, -0.3769919718881114, -0.3748885343552608, NaN, -0.1873613501954139, -0.18897038004249112, NaN, -0.1873613501954139, -0.3748885343552608, NaN, -0.3858844193555435, -0.5830667397437255, NaN, -0.3858844193555435, -0.5830517748177085, NaN, -0.3858844193555435, -0.3748885343552608, NaN, -0.3858844193555435, -0.1873613501954139, NaN, -0.37704592101797574, -0.5521369576265936, NaN, -0.37704592101797574, -0.5503919972289465, NaN, -0.3749207428202086, -0.5503919972289465, NaN, -0.3749207428202086, -0.5830667397437255, NaN, -0.3749207428202086, -0.3858844193555435, NaN, -0.3749207428202086, -0.37704592101797574, NaN, -0.18901479132620036, -0.37704592101797574, NaN, -0.18901479132620036, -0.3749207428202086, NaN, -0.18737825504575678, -0.1873613501954139, NaN, -0.18737825504575678, -0.3858844193555435, NaN, -0.18737825504575678, -0.3749207428202086, NaN, -0.18737825504575678, -0.18901479132620036, NaN, -0.33121364082895033, -0.5412996931425073, NaN, -0.3766208489776397, -0.5412996931425073, NaN, -0.3766208489776397, -0.5521369576265936, NaN, -0.3766208489776397, -0.37704592101797574, NaN, -0.3766208489776397, -0.33121364082895033, NaN, -0.09393652251075124, -0.33121364082895033, NaN, -0.18252064038337357, -0.33121364082895033, NaN, -0.18252064038337357, -0.3766208489776397, NaN, -0.18252064038337357, -0.09393652251075124, NaN, -0.18958741176282246, -0.37704592101797574, NaN, -0.18958741176282246, -0.18901479132620036, NaN, -0.18958741176282246, -0.3766208489776397, NaN, -0.18958741176282246, -0.18252064038337357, NaN, 0.17183824070997344, -0.09393652251075124, NaN, 0.014106860845818359, -0.18252064038337357, NaN, 0.014106860845818359, -0.18958741176282246, NaN, 0.014106860845818359, 0.21120790696160974, NaN, 0.4086249185232831, 0.17183824070997344, NaN, 0.22691981696034857, 0.21120790696160974, NaN, 0.22691981696034857, 0.17183824070997344, NaN, 0.22691981696034857, 0.014106860845818359, NaN, 0.22691981696034857, 0.4086249185232831, NaN, 0.026482690379719065, -0.09393652251075124, NaN, 0.026482690379719065, -0.18252064038337357, NaN, 0.026482690379719065, 0.17183824070997344, NaN, 0.026482690379719065, 0.014106860845818359, NaN, 0.026482690379719065, 0.22691981696034857, NaN, 0.41344820853889863, 0.21120790696160974, NaN, 0.41344820853889863, 0.4086249185232831, NaN, 0.41344820853889863, 0.22691981696034857, NaN, 0.20066050876084907, 0.21120790696160974, NaN, 0.38764819113503757, 0.20066050876084907, NaN, 0.38764819113503757, 0.39350740647459137, NaN, 0.004683430943029254, -0.18901479132620036, NaN, 0.004683430943029254, -0.18737825504575678, NaN, 0.004683430943029254, 0.20066050876084907, NaN, 0.3938066970787091, 0.21120790696160974, NaN, 0.3938066970787091, 0.41344820853889863, NaN, 0.3938066970787091, 0.20066050876084907, NaN, 0.3938066970787091, 0.38764819113503757, NaN, 0.007390825606210516, -0.18901479132620036, NaN, 0.007390825606210516, -0.18958741176282246, NaN, 0.007390825606210516, 0.21120790696160974, NaN, 0.007390825606210516, 0.014106860845818359, NaN, 0.007390825606210516, 0.20066050876084907, NaN, 0.007390825606210516, 0.004683430943029254, NaN, 0.005219481718707009, -0.1873613501954139, NaN, 0.005219481718707009, -0.18737825504575678, NaN, 0.005219481718707009, 0.004683430943029254, NaN, 0.19726304887057577, 0.20066050876084907, NaN, 0.19726304887057577, 0.39350740647459137, NaN, 0.19726304887057577, 0.38764819113503757, NaN, 0.19726304887057577, 0.004683430943029254, NaN, 0.19726304887057577, 0.005219481718707009, NaN, 0.3876670876372412, 0.39350740647459137, NaN, 0.39383452622542814, 0.3876670876372412, NaN, 0.007438209958518849, -0.18953181215346349, NaN, 0.007438209958518849, -0.18897038004249112, NaN, 0.0047125739054301174, -0.18897038004249112, NaN, 0.0047125739054301174, -0.1873613501954139, NaN, 0.0047125739054301174, 0.005219481718707009, NaN, 0.0047125739054301174, 0.007438209958518849, NaN, 0.19727606102851714, 0.39350740647459137, NaN, 0.19727606102851714, 0.005219481718707009, NaN, 0.19727606102851714, 0.19726304887057577, NaN, 0.19727606102851714, 0.3876670876372412, NaN, 0.19727606102851714, 0.0047125739054301174, NaN, 0.20069446181256878, 0.3876670876372412, NaN, 0.20069446181256878, 0.39383452622542814, NaN, 0.20069446181256878, 0.007438209958518849, NaN, 0.20069446181256878, 0.0047125739054301174, NaN, 0.20069446181256878, 0.19727606102851714, NaN, 0.17187561156024977, -0.09388531123764621, NaN, 0.17187561156024977, 0.4086524304938699, NaN, 0.21124921187712387, 0.39383452622542814, NaN, 0.21124921187712387, 0.007438209958518849, NaN, 0.21124921187712387, 0.20069446181256878, NaN, 0.01415516509128456, -0.18953181215346349, NaN, 0.01415516509128456, -0.18247111203820143, NaN, 0.01415516509128456, 0.007438209958518849, NaN, 0.01415516509128456, 0.21124921187712387, NaN, 0.22695248892037312, 0.4086524304938699, NaN, 0.22695248892037312, 0.17187561156024977, NaN, 0.22695248892037312, 0.21124921187712387, NaN, 0.22695248892037312, 0.01415516509128456, NaN, 0.41347212132688727, 0.39383452622542814, NaN, 0.41347212132688727, 0.4086524304938699, NaN, 0.41347212132688727, 0.21124921187712387, NaN, 0.41347212132688727, 0.22695248892037312, NaN, 0.026520006248759387, -0.09388531123764621, NaN, 0.026520006248759387, -0.18247111203820143, NaN, 0.026520006248759387, 0.17187561156024977, NaN, 0.026520006248759387, 0.01415516509128456, NaN, 0.026520006248759387, 0.22695248892037312, NaN, 0.5800380612368166, 0.39383452622542814, NaN, 0.5800380612368166, 0.41347212132688727, NaN, 0.7953323084544623, 0.5800380612368166, NaN, 0.6199039895270659, 0.4086524304938699, NaN, 0.6199039895270659, 0.41347212132688727, NaN, 0.6199039895270659, 0.5800380612368166, NaN, 0.6199039895270659, 0.7953323084544623, NaN, 0.5911799759480498, 0.39350740647459137, NaN, 0.5911799759480498, 0.3876670876372412, NaN, 0.5703206333554993, 0.3876670876372412, NaN, 0.5703206333554993, 0.39383452622542814, NaN, 0.5703206333554993, 0.5800380612368166, NaN, 0.5703206333554993, 0.5911799759480498, NaN, 0.7423992545313376, 0.5800380612368166, NaN, 0.7423992545313376, 0.7953323084544623, NaN, 0.7423992545313376, 0.5703206333554993, NaN, 0.7822899734375146, 0.5911799759480498, NaN, 0.7822899734375146, 0.5703206333554993, NaN, 0.7822899734375146, 0.7423992545313376, NaN, 0.9922338083290616, 0.7822899734375146, NaN, 0.9300033233749574, 0.7953323084544623, NaN, 0.9300033233749574, 0.7423992545313376, NaN, 0.9300033233749574, 0.7822899734375146, NaN, 0.9300033233749574, 0.9922338083290616, NaN, 0.8026530143801951, 0.5911799759480498, NaN, 0.8026530143801951, 0.7822899734375146, NaN, 0.8026530143801951, 0.9922338083290616, NaN, 0.7822828619359941, 0.8026530143801951, NaN, 0.7423930820369335, 0.7822828619359941, NaN, 0.591172746564576, 0.39350740647459137, NaN, 0.591172746564576, 0.38764819113503757, NaN, 0.591172746564576, 0.5911799759480498, NaN, 0.591172746564576, 0.8026530143801951, NaN, 0.591172746564576, 0.7822828619359941, NaN, 0.5703052325113673, 0.38764819113503757, NaN, 0.5703052325113673, 0.3938066970787091, NaN, 0.5703052325113673, 0.7822828619359941, NaN, 0.5703052325113673, 0.7423930820369335, NaN, 0.5703052325113673, 0.591172746564576, NaN, 0.92999869760509, 0.7822828619359941, NaN, 0.92999869760509, 0.7423930820369335, NaN, 0.9922321759207569, 0.9922338083290616, NaN, 0.9922321759207569, 0.8026530143801951, NaN, 0.9922321759207569, 0.7822828619359941, NaN, 0.9922321759207569, 0.92999869760509, NaN, 0.6198861346071187, 0.4086249185232831, NaN, 0.6198861346071187, 0.41344820853889863, NaN, 0.5800262182849156, 0.41344820853889863, NaN, 0.5800262182849156, 0.3938066970787091, NaN, 0.5800262182849156, 0.7423930820369335, NaN, 0.5800262182849156, 0.5703052325113673, NaN, 0.5800262182849156, 0.6198861346071187, NaN, 0.795322867083831, 0.7423930820369335, NaN, 0.795322867083831, 0.92999869760509, NaN, 0.795322867083831, 0.6198861346071187, NaN, 0.795322867083831, 0.5800262182849156, NaN]

    digs = 6

    x, y = distmesh2d(fd, fh, [-1.0 -1.0; 1.0 1.0], 0.2)
    expectedy = sort(filter(value -> !isnan(value), expectedy))
    expectedx = sort(filter(value -> !isnan(value), expectedx))
    x = sort(filter(value -> !isnan(value), x))
    y = sort(filter(value -> !isnan(value), y))
    expectedx = map(value -> round(value, digits = digs), expectedx)
    expectedy = map(value -> round(value, digits = digs), expectedy)
    x = map(value -> round(value, digits = digs), x)
    y = map(value -> round(value, digits = digs), y)
    @test expectedx == x
    @test expectedy == y
end
